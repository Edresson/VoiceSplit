<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>VoiceFilter: Targeted Voice Separation by Speaker-Conditioned Spectrogram Masking</title>
  <link rel="stylesheet" type="text/css" href="./resources/stylesheet.css">
  <link rel="shortcut icon" href="../../resources/logo.png">
  <style>
    code {
      display: block;
      white-space: pre-wrap
    }
  </style>
</head>

<body>
  <div>
    <h1>Pytorch unofficial implementation of VoiceFilter: Targeted Voice Separation by Speaker-Conditioned Spectrogram Masking</h1>

    <p><b>Paper:</b> <a href="https://arxiv.org/abs/1810.04826">arXiv</a></p>
    <p><b>Authors:</b> Quan Wang *, Hannah Muckenhirn *, Kevin Wilson,
      Prashant Sridhar, Zelin Wu, John Hershey, Rif A. Saurous, Ron J. Weiss,
      Ye Jia, Ignacio Lopez Moreno. <i>(*: Equal contribution.)</i>
    </p>

    <p><b>Abstract:</b>
      In this paper, we present a novel system that separates the voice of a target speaker from multi-speaker signals,
      by making use of a reference signal from the target speaker. We achieve this by training two separate neural
      networks: (1) A speaker recognition network that produces speaker-discriminative embeddings; (2) A spectrogram
      masking network that takes both noisy spectrogram and speaker embedding as input, and produces a mask. Our system
      significantly reduces the speech recognition WER on multi-speaker signals, with minimal WER degradation on
      single-speaker signals.
    </p>

    <p><b>System architecture:</b></p>
    <p><img src="resources/architecture.png" width="560"></p>
    <p><b>Citation:</b></p>
    <code>
      @inproceedings{Wang2019,
      author={Quan Wang and Hannah Muckenhirn and Kevin Wilson and Prashant Sridhar and Zelin Wu and John R. Hershey and
      Rif A. Saurous and Ron J. Weiss and Ye Jia and Ignacio Lopez Moreno},
      title={{VoiceFilter: Targeted Voice Separation by Speaker-Conditioned Spectrogram Masking}},
      year=2019,
      booktitle={Proc. Interspeech 2019},
      pages={2728--2732},
      doi={10.21437/Interspeech.2019-1101},
      url={http://dx.doi.org/10.21437/Interspeech.2019-1101}
      }
    </code>

   
    <h2> Improvements </h2>
    <ol>
      <li> We use Si-SNR with PIT instead of Power Law compressed loss, because it allows us to achieve a better result ( comparison available in: https://github.com/Edresson/VoiceSplit).</li>
      <li> We used the MISH activation function instead of ReLU and this has improved the result </li>   
    </ol>

    <h2>Random audio samples from LibriSpeech testing set</h2>
    <p>VoiceFilter model: CNN + bi-LSTM + fully connected + Si-SNR with PIT loss</p>

    <h3>Apply VoiceFilter on noisy audio (2 speakers)</h3>

    <p>Meaning of the columns in the table below:
      <ol>
        <li>The noisy audio input to the VoiceFilter. It's generated by summing the clean audio with an interference
          audio from another speaker.</li>
        <li>The output from the VoiceFilter.</li>
        <li>The reference audio from which we extract the d-vector. The d-vector is another input to the VoiceFilter.
          This audio comes from the same speaker as the clean audio.</li>
        <li>The clean audio, which is the ground truth.</li>
      </ol>
    </p>
    <table>
      <thead>
        <tr>
          <th>Noisy audio input</th>
          <th>Enhanced audio output</th>
          <th>Reference audio for d-vector</th>
          <th>Clean audio (ground truth)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/noisy/6841-88291-0003.1585-157660-0013.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/predict/6841-88291-0003.1585-157660-0013.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/6841-88294-0035.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/6841-88291-0003.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/noisy/1988-147956-0028.84-121123-0026.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/predict/1988-147956-0028.84-121123-0026.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/1988-148538-0011.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/1988-147956-0028.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/noisy/251-137823-0002.6455-67803-0007.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/predict/251-137823-0002.6455-67803-0007.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/251-137823-0003.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/251-137823-0002.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/noisy/5849-50964-0009.6267-65525-0027.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/predict/5849-50964-0009.6267-65525-0027.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/5849-50873-0018.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/5849-50964-0009.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/noisy/2078-142845-0028.4153-186222-0000.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/predict/2078-142845-0028.4153-186222-0000.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/2078-142845-0015.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/2078-142845-0028.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/noisy/6241-61943-0015.84-121123-0002.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/predict/6241-61943-0015.84-121123-0002.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/6241-66616-0019.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/6241-61943-0015.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/noisy/2902-9008-0008.116-288045-0003.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/predict/2902-9008-0008.116-288045-0003.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/2902-9006-0010.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/2902-9008-0008.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/noisy/3081-166546-0036.3170-137482-0042.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/predict/3081-166546-0036.3170-137482-0042.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/3081-166546-0016.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/3081-166546-0036.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/noisy/1701-141760-0023.251-136532-0023.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/predict/1701-141760-0023.251-136532-0023.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/1701-141759-0022.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/1701-141760-0023.wav" type="audio/wav"></audio></td>
          
        </tr>

        <tr>
          <td><audio controls class="audio-player" preload="metadata">
            <source src="audios_demo/2_speakers/noisy/4831-18525-0005.3576-138058-0010.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/2_speakers/predict/4831-18525-0005.3576-138058-0010.wav" type="audio/wav"></audio>
          </td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/4831-29134-0017.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/4831-18525-0005.wav" type="audio/wav"></audio></td>
        </tr>
        
      </tbody>
    </table>

    <h3>Apply VoiceFilter on clean audio (single speaker)</h3>

    <p>Meaning of the columns in the table below:
      <ol>
        <li>The clean audio, which we feed as the input to the VoiceFilter.</li>
        <li>The output from the VoiceFilter.</li>
        <li>The reference audio from which we extract the d-vector. The d-vector is another input to the VoiceFilter.
          This audio comes from the same speaker as the clean audio.</li>
      </ol>
    </p>
    <table>
      <thead>
        <tr>
          <th>Clean audio input</th>
          <th>Enhanced audio output</th>
          <th>Reference audio for d-vector</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/6841-88291-0003.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/single_speaker/predict/6841-88291-0003.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/6841-88294-0035.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/1988-147956-0028.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/single_speaker/predict/1988-147956-0028.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/1988-148538-0011.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/251-137823-0002.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/single_speaker/predict/251-137823-0002.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/251-137823-0003.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/5849-50964-0009.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/single_speaker/predict/5849-50964-0009.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/5849-50873-0018.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/2078-142845-0028.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/single_speaker/predict/2078-142845-0028.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/2078-142845-0015.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/6241-61943-0015.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/single_speaker/predict/6241-61943-0015.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/6241-66616-0019.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/2902-9008-0008.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/single_speaker/predict/2902-9008-0008.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/2902-9006-0010.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/3081-166546-0036.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/single_speaker/predict/3081-166546-0036.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/3081-166546-0016.wav" type="audio/wav"></audio></td>
        </tr>
        <tr>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/clean/1701-141760-0023.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/single_speaker/predict/1701-141760-0023.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/1701-141759-0022.wav" type="audio/wav"></audio></td>
         </tr>
         <tr>
          <td><audio controls class="audio-player" preload="metadata">
            <source src="audios_demo/clean/4831-18525-0005.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/single_speaker/predict/4831-18525-0005.wav" type="audio/wav"></audio></td>
          <td><audio controls class="audio-player" preload="metadata">
              <source src="audios_demo/reference/4831-29134-0017.wav" type="audio/wav"></audio></td>
        </tr>
      </tbody>
    </table>

    <h2>FAQ</h2>

    <h2>Dataset information</h2>

    <p>
      For training and evaluating our VoiceFilter models, we had been using the
       LibriSpeech dataset.
    </p>
    <p>
      Here we provide the division of
      training-vs-testing as CSV files. Each line of the CSV files is a tuple
      of three utterance IDs:
    </p>
    <p>
      <b>
        (clean utterance, utterance for computing d-vector, interference utterance)
      </b>
      <li>
        <a href="https://github.com/Edresson/VoiceSplit/tree/master/datasets/LibriSpeech">
          LibriSpeech training and testing</a>
      </li>
    </p>
  </div>
</body>

</html>